# Application Configuration
spring:
  application:
    name: gateway-service
  main:
    web-application-type: reactive
  
  # Deshabilitar default resource handling (WebFlux)
  # El gateway no sirve contenido estático - solo redirige requests
  webflux:
    resources:
      add-mappings: false

# CORS Configuration
cors:
  allowed-origins:
    - http://localhost:5173  # Vite dev server (frontend)
    - http://localhost:3000  # React/Next.js dev server
    - http://localhost:3001  # React/Next.js dev server
    - ${CORS_ALLOWED_ORIGINS_PROD:http://frontend:80}  # Internal frontend container URL (Docker Compose/production)
    # Para producción, reemplazar con:
    # - https://app.docflow.com
    # - https://admin.docflow.com

# Server Configuration
server:
  port: 8080

# Spring Cloud Gateway Configuration
spring.cloud.gateway:
  httpclient:
    connect-timeout: 5000
    response-timeout: 10s
  default-filters:
    - DedupeResponseHeader=Access-Control-Allow-Origin Access-Control-Allow-Credentials, RETAIN_UNIQUE

# JWT Configuration (must match identity-service configuration)
jwt:
  secret: ${JWT_SECRET:docflow-secret-key-change-this-in-production-min-256-bits-required-for-security}

# SpringDoc OpenAPI Configuration (WebFlux)
springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs
  swagger-ui:
    enabled: true
    path: /webjars/swagger-ui/index.html
    urls:
      - name: Gateway API
        url: /v3/api-docs
    operationsSorter: method
    tagsSorter: alpha
  info:
    title: DocFlow Gateway API
    description: API Gateway for DocFlow microservices architecture
    version: 0.0.1-SNAPSHOT
    contact:
      name: DocFlow Team

# Spring Boot Actuator Configuration (WebFlux)
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,routes
  endpoint:
    health:
      show-details: always

# Logging Configuration
logging:
  level:
    root: INFO
    com.docflow.gateway: DEBUG
    org.springframework.cloud.gateway: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
